---
title: "PSTAT131 Final Project"
author: "Joseph Chang, Tom Wei, Akul Bajaj"
date: "3/11/2022"
output: pdf_document
---

```{r setup, include=FALSE, echo = FALSE}
# set global chunk options: images will be 7x5 inches
knitr::opts_chunk$set(fig.width=7, fig.height=5, echo =TRUE)
options(digits = 4)
```

## packages
```{r}
#install.packages("tidyverse")
library(tidyverse)
library(knitr)
library(dplyr)
library(tidyverse)
library(modelr)
library(pander)
```

## read data
```{r}
# this is where we will input the data 

# first dataset
X2020_2021_NBA_Stats_Player_Box_Score_Advanced_Metrics
bball_stats <- as.data.frame(X2020_2021_NBA_Stats_Player_Box_Score_Advanced_Metrics)
my_colnames <- c('Rank', 'Player', 'Team', 'Position', 'Age', 'Games Played', 'MPG', 'Minutes%', 'Usage Rate' , 'Turnover rate', 'free throws attempted', 'Free throw percentage', '2-point field goals attempted', '2-point percentage', '3-point field goals attempted', 'three-point percentage', 'effective shooting percentage' , 'True shooting percentage', 'PPG', 'RPG', 'Total rebound percentage', 'APG', 'Assist percentage', 'SPG' ,'BPG', 'TPG', 'Versatility Index', 'Offensive Rating' , 'Defensive rating')
colnames(bball_stats) <- my_colnames
new_bball_stats <- bball_stats[-1,-1]
new_bball_stats

# second dataset
labels <- c('Player','Position', 'Age', 'Team', 'Games', 'Minutes played', 'Player Efficiency Rating', 'true shooting percentage', '3-point attempt rate', 'free-throw attempt rate', 'offensive rebound percentage', 'defensive rebound percentage', 'total rebound percentage', 'assist percentage', 'steal percentage', 'block percentage', 'turnover percentage', 'usage rate', 'offensive win shares', 'defensive win shares', 'win shares','win shares per 48 minutes', 'Offensive Box Plus/Minus', 'Defensive Box Plus/Minus','Box Plus/Minus','Value Over Replacement')
data_advanced <- read.csv("nba2021_advanced.csv", col.names = labels, na= "XXX")
data_advanced
```

## here is a comment
## Merge data?
```{r}
# this is where we merge data
master_data <- merge(new_bball_stats, data_advanced, by.x ='Player', by.y = 'Player')

# cut down all predictors to only 24 predictors
less_data <- subset(master_data, select= -c(2:4,7,9,10,12:14,20, 22,29,31,32,35:44, 45,49:51, 53))
#all_data <- subset(master_data, select= c(1:3,5:28,30,33:44, 46:53))
less_data
glimpse(less_data)
```

## filter data
```{r}
# filter players with total minutes played over 100 
our_data <- less_data %>% filter(Minutes.played >= 100) %>% select(Player:Box.Plus.Minus)
our_data
```

## Check to see Correlation
```{r}
# correlation to see predictors vs other predictors in bball_data_advanced 
my_cor <- bball_data_advanced %>% select(-c(Player, Position, Team)) %>% cor() %>% round(5)
#my_cor <- all_data %>% select(-c(Player)) %>% cor() %>% round(5)
my_cor[(abs(my_cor) > 0.8)] 
```

## Plot
```{r}
plot()
```


## Linear regression?
```{r}
w <- our_data[-1]
fit <- lm(Minutes.played ~ ., data = w)
summary(fit)
```


## training and testing data
```{r}
# Set random seed
set.seed(3112022)

# Sample 70% observations as training data
train = sample(1:nrow(seats), 648*0.7)
seats.train = seats[train,]

# The rest 50% as test data
seats.test = seats[-train,]
```









